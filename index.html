<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Three.js - Fundamentals with light</title>
  </head>
  <style>
    html, body {
    height: 100%;
    margin: 0;
    }
    #c {
    width: 100%;
    height: 100%;
    display: block;
    }
    </style>

  <body>
    <canvas id="c" ></canvas>
  </body>
    <script  type="importmap">{
        "imports": {
            "three": "https://threejs.org/build/three.module.js",
            "three/addons/": "https://threejs.org/examples/jsm/"
        }
        }
    </script>
	<script type="module">
		import * as THREE from 'three';
		import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
		import { GUI } from 'three/addons/libs/lil-gui.module.min.js';
		import { Water } from 'three/addons/objects/Water.js';

		function main() {

		const canvas = document.querySelector( '#c' );
		//const renderer = new THREE.WebGLRenderer( { antialias: true, canvas } );
		// want to use skybox 
		const renderer = new THREE.WebGLRenderer( { antialias: true, canvas } );


		const fov = 100;
		const aspect = 2; // the canvas default
		const near = 0.1;
		const far = 10000;
		const camera = new THREE.PerspectiveCamera( fov, aspect, near, far );
		camera.position.set( 0, 10, 20 );

		// using example from "cameras" as a basic guide
		function updateCamera() {
			camera.updateProjectionMatrix();
		}

		const controls = new OrbitControls( camera, canvas );
		controls.target.set( 0, 10, 15 );
		controls.update();

		const scene = new THREE.Scene();
		const waterGeometry = new THREE.PlaneGeometry( 10000, 10000 );
        let water;
        water = new Water(
            waterGeometry,
            {
                textureWidth: 10000,
                textureHeight: 10000,
                waterNormals: new THREE.TextureLoader().load( 'waternormals.jpg', function ( texture ) {

                    texture.wrapS = texture.wrapT = THREE.RepeatWrapping;

                } ),
                
                sunDirection: new THREE.Vector3(),
                sunColor: 0xffffff,
                waterColor: 0x001e0f,
                distortionScale: 3.7,
                fog: scene.fog !== undefined
            }
        );

        water.rotation.x = - Math.PI / 2;

        scene.add( water );

		//scene.background = new THREE.Color( 'black' );
		
		//loading in a 3d scenery
		{
		const loader = new THREE.CubeTextureLoader();
		const texture = loader.load([
			'cubemap/pano_r.jpg', //pos-x
			'cubemap/pano_l.jpg', //neg-x

			'cubemap/pano_u.jpg', //pos-y
			'cubemap/pano_d.jpg', //neg-y

			'cubemap/pano_f.jpg', //pos-z
			'cubemap/pano_b.jpg', //neg-z
			//bfrl 
			//sourced from https://www.utah3d.net/utah-travel/utah-waterways/starry-lake.html
		]);
		scene.background = texture;
		}

		{

			const cubeSize = 4;
			const cubeGeo = new THREE.BoxGeometry( cubeSize, cubeSize, cubeSize );
			const cubeMat = new THREE.MeshPhongMaterial( { color: '#8AC' } );
			const mesh = new THREE.Mesh( cubeGeo, cubeMat );
			mesh.position.set( cubeSize + 1, cubeSize / 2, 0 );
			scene.add( mesh );

		}

		{

			const color = 0xFFFFFF;
			const intensity = 3;
			const light = new THREE.DirectionalLight( color, intensity );
			light.position.set( 0, 10, 0 );
			light.target.position.set( - 5, 0, 0 );
			scene.add( light );
			scene.add( light.target );

		}

		function resizeRendererToDisplaySize( renderer ) {

			const canvas = renderer.domElement;
			const width = canvas.clientWidth;
			const height = canvas.clientHeight;
			const needResize = canvas.width !== width || canvas.height !== height;
			if ( needResize ) {

				renderer.setSize( width, height, false );

			}

			return needResize;

		}

		function render() {

			if ( resizeRendererToDisplaySize( renderer ) ) {

				const canvas = renderer.domElement;
				camera.aspect = canvas.clientWidth / canvas.clientHeight;
				camera.updateProjectionMatrix();

			}

			renderer.render( scene, camera );

			requestAnimationFrame( render );

		}

		requestAnimationFrame( render );

	}

	main();
	</script>
	
